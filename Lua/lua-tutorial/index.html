<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"fetasty.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"flat"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Lua编译Lua 5.3.5 下载lua5.3.5源码并解压 www.lua.org&#x2F;ftp&#x2F;  下载配置好Mingw64  cd到src目录, 运行以下命令 1mingw32-make.exe mingw  将生成在src目录下的文件按结构拷贝 12345678bin:    lua luac lua53[库文件 dll或其它格式]include:    lua.h luaconf.h lual">
<meta property="og:type" content="article">
<meta property="og:title" content="Lua简明教程">
<meta property="og:url" content="http://fetasty.github.io/lua/lua-tutorial/index.html">
<meta property="og:site_name" content="fetasty">
<meta property="og:description" content="Lua编译Lua 5.3.5 下载lua5.3.5源码并解压 www.lua.org&#x2F;ftp&#x2F;  下载配置好Mingw64  cd到src目录, 运行以下命令 1mingw32-make.exe mingw  将生成在src目录下的文件按结构拷贝 12345678bin:    lua luac lua53[库文件 dll或其它格式]include:    lua.h luaconf.h lual">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-05-25T11:31:40.000Z">
<meta property="article:modified_time" content="2020-10-20T15:02:04.215Z">
<meta property="article:author" content="EricYe">
<meta property="article:tag" content="Lua">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://fetasty.github.io/lua/lua-tutorial/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Lua简明教程 | fetasty</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">fetasty</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">念念不忘, 必有回响</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://fetasty.github.io/lua/lua-tutorial/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="EricYe">
      <meta itemprop="description" content="The compiler in my hand will be a part of my soul.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fetasty">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Lua简明教程
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-05-25 19:31:40" itemprop="dateCreated datePublished" datetime="2020-05-25T19:31:40+08:00">2020-05-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-20 23:02:04" itemprop="dateModified" datetime="2020-10-20T23:02:04+08:00">2020-10-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/lua/" itemprop="url" rel="index"><span itemprop="name">Lua</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/lua/lua-tutorial/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/lua/lua-tutorial/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Lua"><a href="#Lua" class="headerlink" title="Lua"></a>Lua</h1><h2 id="编译Lua-5-3-5"><a href="#编译Lua-5-3-5" class="headerlink" title="编译Lua 5.3.5"></a>编译Lua 5.3.5</h2><ol>
<li><p>下载lua5.3.5源码并解压 <a target="_blank" rel="noopener" href="http://www.lua.org/ftp/">www.lua.org/ftp/</a></p>
</li>
<li><p>下载配置好Mingw64</p>
</li>
<li><p>cd到src目录, 运行以下命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mingw32-make.exe mingw</span><br></pre></td></tr></table></figure>
</li>
<li><p>将生成在src目录下的文件按结构拷贝</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bin:</span><br><span class="line">    lua luac lua53[库文件 dll或其它格式]</span><br><span class="line">include:</span><br><span class="line">    lua.h luaconf.h lualib.h lauxlib.h lua.hpp</span><br><span class="line">lib:</span><br><span class="line">    liblua.a</span><br><span class="line">man&#x2F;man1:</span><br><span class="line">    lua.1 luac.1</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><h3 id="Hello-Word"><a href="#Hello-Word" class="headerlink" title="Hello Word"></a>Hello Word</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hello word&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 单行注释</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">多行注释</span></span><br><span class="line"><span class="comment">多行注释</span></span><br><span class="line"><span class="comment">]]</span></span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h3 id="全局-局部变量"><a href="#全局-局部变量" class="headerlink" title="全局/局部变量"></a>全局/局部变量</h3><p>lua变量默认就是全局的, 注意尽量不要申请全局变量</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- test.lua</span></span><br><span class="line">a = <span class="number">5</span>                <span class="comment">-- 全局变量</span></span><br><span class="line"><span class="keyword">local</span> b = <span class="number">6</span>            <span class="comment">-- 局部变量 文件内有效</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a, b)            <span class="comment">-- 5 6</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">joke</span><span class="params">()</span></span>        <span class="comment">-- 全局函数</span></span><br><span class="line">    c = <span class="number">5</span>            <span class="comment">-- 全局变量</span></span><br><span class="line">    <span class="keyword">local</span> d = <span class="number">6</span>        <span class="comment">-- 局部变量 函数内有效</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>    <span class="comment">-- 局部函数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;test&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>



<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p>lua有8个基本类型</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>nil</td>
<td>这个最简单，只有值nil属于该类，表示一个无效值（在条件表达式中相当于false）。</td>
</tr>
<tr>
<td>boolean</td>
<td>包含两个值：false和true。</td>
</tr>
<tr>
<td>number</td>
<td>表示双精度类型的实浮点数</td>
</tr>
<tr>
<td>string</td>
<td>字符串由一对双引号或单引号来表示</td>
</tr>
<tr>
<td>function</td>
<td>由 C 或 Lua 编写的函数</td>
</tr>
<tr>
<td>userdata</td>
<td>表示任意存储在变量中的C数据结构</td>
</tr>
<tr>
<td>thread</td>
<td>表示执行的独立线路，用于执行协同程序</td>
</tr>
<tr>
<td>table</td>
<td>Lua 中的表（table）其实是一个”关联数组”（associative arrays），数组的索引可以是数字、字符串或表类型。在 Lua 里，table 的创建是通过”构造表达式”来完成，最简单构造表达式是{}，用来创建一个空表。</td>
</tr>
</tbody></table>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="string">&quot;Hello world&quot;</span>))      <span class="comment">-- string</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="number">10.4</span>*<span class="number">3</span>))             <span class="comment">-- number</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="built_in">print</span>))              <span class="comment">-- function</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="built_in">type</span>))               <span class="comment">-- function</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="literal">true</span>))               <span class="comment">-- boolean</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="literal">nil</span>))                <span class="comment">-- nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="built_in">type</span>(X)))            <span class="comment">-- string</span></span><br></pre></td></tr></table></figure>

<h3 id="nil"><a href="#nil" class="headerlink" title="nil"></a>nil</h3><p>删除作用: 对于变量和table, 将变量或者table表里的变量赋值为nil, 等同于把它们删掉</p>
<h3 id="变量作为判断条件"><a href="#变量作为判断条件" class="headerlink" title="变量作为判断条件"></a>变量作为判断条件</h3><p>作为循环/if的判断条件: <strong>有且仅有false和nil判断为false; 其它都为true, 包括0, 空字符串和空表</strong></p>
<h2 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h2><h3 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h3><p>lua中没有switch分支, 只有if分支</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> cond1 <span class="keyword">then</span></span><br><span class="line">    <span class="comment">-- code1</span></span><br><span class="line"><span class="keyword">elseif</span> cond2 <span class="keyword">then</span></span><br><span class="line">    <span class="comment">-- code2</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> condition <span class="keyword">then</span></span><br><span class="line">    <span class="comment">-- code</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><p>lua中没有continue语句, 但是有break语句</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">10</span></span><br><span class="line"><span class="keyword">while</span> a &lt; <span class="number">20</span> <span class="keyword">do</span></span><br><span class="line">    <span class="comment">-- some code</span></span><br><span class="line">    a = a + <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">3</span> <span class="keyword">do</span>            <span class="comment">-- i从1到5, 每次递增1</span></span><br><span class="line">    <span class="built_in">print</span>(i)            <span class="comment">-- 1 2 3</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i = <span class="number">3</span>, <span class="number">1</span>, <span class="number">-1</span> <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(i)            <span class="comment">-- 3 2 1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">repeat</span></span><br><span class="line">    <span class="comment">-- some code</span></span><br><span class="line"><span class="keyword">until</span> condition            <span class="comment">-- 条件为false时循环</span></span><br></pre></td></tr></table></figure>

<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="函数定义"><a href="#函数定义" class="headerlink" title="函数定义"></a>函数定义</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">(num)</span></span>            <span class="comment">-- 全局函数, 返回值为nil</span></span><br><span class="line">    <span class="built_in">print</span>(num)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">(num)</span></span>    <span class="comment">-- 局部函数</span></span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> test = <span class="function"><span class="keyword">function</span><span class="params">(num)</span></span>    <span class="comment">-- 与上面的代码相同</span></span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h3 id="返回多个值"><a href="#返回多个值" class="headerlink" title="返回多个值"></a>返回多个值</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> test = <span class="function"><span class="keyword">function</span><span class="params">(num)</span></span>    <span class="comment">-- 返回多值</span></span><br><span class="line">    <span class="keyword">return</span> num, num * <span class="number">2</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> a, b = test(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">local</span> _, t = test(<span class="number">3</span>)        <span class="comment">-- 丢弃部分返回值</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">local</span> t = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">unpack</span>(t)        <span class="comment">-- return t是返回一个表</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> _, a, b = test()</span><br><span class="line"><span class="built_in">print</span>(a, b)</span><br></pre></td></tr></table></figure>

<h3 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">(...)</span></span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(<span class="built_in">arg</span>) <span class="keyword">do</span>            <span class="comment">-- 传入的参数以table存入, arg[&quot;n&quot;]为参数个数, 会取到n</span></span><br><span class="line">        <span class="built_in">print</span>(k, v)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">ipairs</span>(&#123;...&#125;) <span class="keyword">do</span>         <span class="comment">-- &#123;...&#125;是用传入参数组成的数组</span></span><br><span class="line">        <span class="built_in">print</span>(i, v)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;参数个数为&quot;</span>..#<span class="built_in">arg</span>)             <span class="comment">-- lua5.3.5测试这里总是正确, 即使中间有nil, 长度也正确; 如果不正确, 试试select(&quot;#&quot;, ...)</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><h3 id="表示"><a href="#表示" class="headerlink" title="表示"></a>表示</h3><p><code>[[ ]]</code>包含的字符串原样输出, 包括换行, 空白, 引号, 转义字符</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">string1 = <span class="string">&quot;lua&quot;</span>                <span class="comment">-- lua</span></span><br><span class="line">string2 = <span class="string">&#x27;lua&#x27;</span>                <span class="comment">-- lua</span></span><br><span class="line">string3 = <span class="string">[[&quot;lua数据&quot;\nss]]</span>       <span class="comment">-- &quot;lua数据&quot;\nss</span></span><br><span class="line">string4 = string1..<span class="string">&quot;&amp;&amp;&quot;</span>        <span class="comment">-- lua&amp;&amp; (字符串拼接, 每次拼接需要重新申请空间)</span></span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>: 大量字符串拼接时不要使用<code>..</code>, 每次重新申请空间带来的开销很大, 可以用<code>table.insert()</code>先保存到数组, 再<code>table.concat()</code>合并</p>
<h3 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span>.<span class="built_in">upper</span>(<span class="string">&quot;Lua&quot;</span>)            <span class="comment">-- LUA</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">lower</span>(<span class="string">&quot;Lua&quot;</span>)            <span class="comment">-- lua</span></span><br><span class="line"><span class="comment">--[[ string.gsub(main, find, replace, num) 替换字符串</span></span><br><span class="line"><span class="comment">main为要操作的字符串, find为被替换字符串, replace用来替换的字符串, num替换次数(忽略则全替换)</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">gsub</span>(<span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="number">3</span>) <span class="comment">-- zzza 3</span></span><br><span class="line"><span class="comment">--[[ string.find(str, substr, [init, [end]]</span>)</span><br><span class="line">init为索引</span><br><span class="line">]]</span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">find</span>(<span class="string">&quot;Hello lua user&quot;</span>, <span class="string">&quot;lua&quot;</span>) <span class="comment">-- 7 9</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">reverse</span>(<span class="string">&quot;lua&quot;</span>) <span class="comment">-- aul</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">char</span>(<span class="number">97</span>,<span class="number">98</span>,<span class="number">99</span>,<span class="number">100</span>) <span class="comment">-- abcd</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">byte</span>(<span class="string">&quot;ABCD&quot;</span>,<span class="number">4</span>) <span class="comment">-- 68 (D的ASCII)</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">byte</span>(<span class="string">&quot;ABC&quot;</span>) <span class="comment">-- 65 (A的ASCII)</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">len</span>(<span class="string">&quot;str&quot;</span>) <span class="comment">-- 3 计算字符串长度, 字节数</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">rep</span>(<span class="string">&quot;abc&quot;</span>, <span class="number">2</span>) <span class="comment">-- abcabc 字符串的n个拷贝</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">gmatch</span>(str, pattern) <span class="comment">-- 每次调用, 则查找下一个模式匹配</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">match</span>(str, pattern init) <span class="comment">-- 返回第一个匹配, init搜寻起始点</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(formatstr, ...) <span class="comment">-- 字符串格式化</span></span><br></pre></td></tr></table></figure>

<h4 id="字符串格式化"><a href="#字符串格式化" class="headerlink" title="字符串格式化"></a>字符串格式化</h4><p>详细: <a target="_blank" rel="noopener" href="https://www.runoob.com/lua/lua-strings.html">lua字符串</a></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">string1 = <span class="string">&quot;Lua&quot;</span></span><br><span class="line">string2 = <span class="string">&quot;Tutorial&quot;</span></span><br><span class="line">number1 = <span class="number">10</span></span><br><span class="line">number2 = <span class="number">20</span></span><br><span class="line"><span class="comment">-- 基本字符串格式化</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;基本格式化 %s %s&quot;</span>,string1,string2))</span><br><span class="line"><span class="comment">-- 日期格式化</span></span><br><span class="line"><span class="built_in">date</span> = <span class="number">2</span>; month = <span class="number">1</span>; year = <span class="number">2014</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;日期格式化 %02d/%02d/%03d&quot;</span>, <span class="built_in">date</span>, month, year))</span><br><span class="line"><span class="comment">-- 十进制格式化</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%.4f&quot;</span>,<span class="number">1</span>/<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 结果</span></span><br><span class="line">基本格式化 Lua Tutorial</span><br><span class="line">日期格式化 <span class="number">02</span>/<span class="number">01</span>/<span class="number">2014</span></span><br><span class="line"><span class="number">0.3333</span></span><br></pre></td></tr></table></figure>

<h4 id="字符串模式匹配"><a href="#字符串模式匹配" class="headerlink" title="字符串模式匹配"></a>字符串模式匹配</h4><p>支持模式的方法</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span>.<span class="built_in">find</span>(s, pattern[, init[, plain]])</span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">match</span>(s, pattern[, init])</span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">gmatch</span>(s, pattern)</span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">gsub</span>(s, pattern, repl[, n])</span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span>.<span class="built_in">match</span>(<span class="string">&#x27;2015-5-12 13:53&#x27;</span>, <span class="string">&#x27;%d+-%d+-%d+&#x27;</span>)    <span class="comment">-- 2015-5-12</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">match</span>(<span class="string">&#x27;2015-5-12 13:53&#x27;</span>, <span class="string">&#x27;(%d+)-(%d+)-(%d+)&#x27;</span>) <span class="comment">-- 2015 5 12</span></span><br></pre></td></tr></table></figure>

<p>详细: <a target="_blank" rel="noopener" href="http://note.youdao.com/noteshare?id=949d9f95814d47328f770da9aa2a2cbb&sub=D0E03ABA00CE49529B4CD226F73CE48E">Lua的字符串匹配与正则表达式</a></p>
<h2 id="表与数组"><a href="#表与数组" class="headerlink" title="表与数组"></a>表与数组</h2><h3 id="表"><a href="#表" class="headerlink" title="表"></a>表</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = &#123;&#125;     <span class="comment">-- 空表, 空数组</span></span><br><span class="line">t[<span class="number">1</span>] = <span class="string">&quot;lua&quot;</span>     <span class="comment">-- 指定值</span></span><br><span class="line">t = <span class="literal">nil</span>         <span class="comment">-- 删除表</span></span><br><span class="line"><span class="keyword">local</span> t1 = &#123;</span><br><span class="line">    [<span class="number">1</span>] = <span class="string">&quot;lua&quot;</span>,</span><br><span class="line">    <span class="string">&quot;wow&quot;</span> = <span class="string">&quot;ss&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = &#123;&#125;</span><br><span class="line">t[<span class="number">1</span>] = <span class="string">&quot;lua&quot;</span></span><br><span class="line">t[<span class="string">&quot;wow&quot;</span>] = <span class="string">&quot;ss&quot;</span></span><br><span class="line"><span class="built_in">print</span>(t[<span class="string">&quot;1&quot;</span>])    <span class="comment">-- nil</span></span><br><span class="line"><span class="built_in">print</span>(t[<span class="string">&quot;wow&quot;</span>]) <span class="comment">-- ss</span></span><br><span class="line"><span class="built_in">print</span>(t.wow)    <span class="comment">-- ss</span></span><br></pre></td></tr></table></figure>

<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p><strong>lua中数组下标从1开始</strong></p>
<p>数组是以数字为下标的表, 但是表不一定是数组!</p>
<p>数组长度: <code>#t</code>, <code>table.getn(t)</code>, 如果<strong>中途有下标跳跃则长度统计中断, 有nil值, 如果nil不为最后一个元素, 则也不影响</strong></p>
<p>这两个操作只能求数组长度, 不要用来求表长度!!</p>
<p>只有以数字作为下标, 才能成为数组</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = &#123;<span class="string">&quot;lua&quot;</span>, <span class="number">333</span>, <span class="string">&quot;ss&quot;</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(#t)                <span class="comment">-- 3</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">getn</span>(t))    <span class="comment">-- 3</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = &#123;</span><br><span class="line">    [<span class="number">1</span>] = <span class="number">33</span>,</span><br><span class="line">    [<span class="string">&quot;ww&quot;</span>] = <span class="string">&quot;ss&quot;</span>,        <span class="comment">-- 表数据, 和数组无关, 最好不要混合使用!</span></span><br><span class="line">    [<span class="number">2</span>] = <span class="number">22</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(#t)                <span class="comment">-- 2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">table</span>.<span class="built_in">getn</span>(t))    <span class="comment">-- 2</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="literal">nil</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(#t)                <span class="comment">-- 2</span></span><br><span class="line">t[<span class="number">4</span>] = <span class="number">4</span>                <span class="comment">-- 相当于local t = &#123;1, 2, nil, 4&#125;</span></span><br><span class="line"><span class="built_in">print</span>(#t)                <span class="comment">-- 4</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = &#123;</span><br><span class="line">    [<span class="number">1</span>] = <span class="number">1</span>,</span><br><span class="line">    [<span class="number">2</span>] = <span class="number">1</span>,</span><br><span class="line">    [<span class="number">5</span>] = <span class="number">1</span>,            <span class="comment">-- 下标跳跃, 统计中断</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(#t)                <span class="comment">-- 2</span></span><br><span class="line"><span class="built_in">print</span>(t[<span class="number">3</span>])                <span class="comment">-- nil</span></span><br></pre></td></tr></table></figure>

<h3 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h3><p>pairs 表遍历, 所有key和value都能遍历到, 无论key是数字还是字符串</p>
<p>ipairs 数组遍历, 只能遍历从1开始的连续数字下标, 中断的数字下标和字符串下标都不会遍历到</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = &#123;</span><br><span class="line">    [<span class="string">&quot;aa&quot;</span>] = <span class="string">&quot;at&quot;</span>,</span><br><span class="line">    [<span class="string">&quot;bb&quot;</span>] = <span class="string">&quot;bt&quot;</span>,</span><br><span class="line">    [<span class="string">&quot;cc&quot;</span>] = <span class="string">&quot;ct&quot;</span>,</span><br><span class="line">    [<span class="number">3</span>] = <span class="string">&quot;3t&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(t) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(k), k, v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- 输出</span></span><br><span class="line">number    <span class="number">3</span>    <span class="number">3</span>t    </span><br><span class="line"><span class="built_in">string</span>    cc    ct    </span><br><span class="line"><span class="built_in">string</span>    aa    at    </span><br><span class="line"><span class="built_in">string</span>    bb    bt</span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = &#123;</span><br><span class="line">    [<span class="number">1</span>] = <span class="string">&quot;1t&quot;</span>,</span><br><span class="line">    [<span class="number">2</span>] = <span class="string">&quot;2t&quot;</span>,</span><br><span class="line">    [<span class="number">3</span>] = <span class="string">&quot;3t&quot;</span>,</span><br><span class="line">    [<span class="number">5</span>] = <span class="string">&quot;5t&quot;</span>,        <span class="comment">-- 中断的下标</span></span><br><span class="line">    [<span class="string">&quot;aa&quot;</span>] = at,    <span class="comment">-- 字符串下标</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">ipairs</span>(t) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(i, v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- 输出</span></span><br><span class="line"><span class="number">1</span>    <span class="number">1</span>t    </span><br><span class="line"><span class="number">2</span>    <span class="number">2</span>t    </span><br><span class="line"><span class="number">3</span>    <span class="number">3</span>t</span><br></pre></td></tr></table></figure>

<h3 id="table常用函数"><a href="#table常用函数" class="headerlink" title="table常用函数"></a>table常用函数</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">table</span>.<span class="built_in">concat</span> (<span class="built_in">table</span> [, sep [, start [, <span class="keyword">end</span>]]]) <span class="comment">-- 将table数组部分从start到end位置元素以sep分隔符连接起来</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">insert</span> (<span class="built_in">table</span>, [pos,] value) <span class="comment">-- 在数组的pos位置(默认尾部)插入一个元素</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">remove</span> (<span class="built_in">table</span> [, pos]) <span class="comment">-- 删除数组指定位置(默认尾部)一个元素, 后续元素前移 (连续删除, 要倒序遍历)</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">sort</span> (<span class="built_in">table</span> [, comp]) <span class="comment">-- 使用比较函数comp从小到大排序数组</span></span><br></pre></td></tr></table></figure>

<h2 id="元表"><a href="#元表" class="headerlink" title="元表"></a>元表</h2><h3 id="设置和获取元表"><a href="#设置和获取元表" class="headerlink" title="设置和获取元表"></a>设置和获取元表</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setmetatable</span>(<span class="built_in">table</span>, metatable)         <span class="comment">-- 设置table的元表为metatable</span></span><br><span class="line"><span class="built_in">getmetatable</span>(<span class="built_in">table</span>)                    <span class="comment">-- 获取元表</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mytable = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123;&#125;)</span><br><span class="line"><span class="comment">-- 相当于如下操作</span></span><br><span class="line">mytable = &#123;&#125;</span><br><span class="line">mymetatable = &#123;&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(mytable, mymetatable)</span><br></pre></td></tr></table></figure>

<h3 id="index"><a href="#index" class="headerlink" title="__index"></a>__index</h3><p>metatable最常用键</p>
<p>通过key访问table时, 如果table中key没有对应value, 则寻找metatable的<code>__index</code>键(假如有metatable); 如果<code>__index</code>是一个表, 则在表中查找; 如果<code>__index</code>是一个函数, 则调用函数, 返回函数返回值</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123;</span><br><span class="line">        <span class="built_in">__index</span> = &#123;[<span class="string">&quot;aa&quot;</span>] = <span class="string">&quot;ss&quot;</span>&#125;</span><br><span class="line">    &#125;)</span><br><span class="line"><span class="built_in">print</span>(t[<span class="string">&quot;aa&quot;</span>])    <span class="comment">-- ss</span></span><br><span class="line"><span class="built_in">print</span>(t.aa)        <span class="comment">-- ss</span></span><br><span class="line"><span class="built_in">print</span>(t.bb)        <span class="comment">-- nil</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123;</span><br><span class="line">        <span class="built_in">__index</span> = <span class="function"><span class="keyword">function</span><span class="params">(self, key)</span></span></span><br><span class="line">            <span class="keyword">return</span> key</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(t[<span class="string">&quot;aa&quot;</span>])    <span class="comment">-- aa</span></span><br><span class="line"><span class="built_in">print</span>(t.aa)        <span class="comment">-- aa</span></span><br></pre></td></tr></table></figure>

<h3 id="newindex"><a href="#newindex" class="headerlink" title="__newindex"></a>__newindex</h3><p><code>__newindex</code>用于更新表</p>
<p>给表的一个<strong>缺少的索引</strong>赋值, 解释器先查找<code>__newindex</code>, 如果存在, 则更新<code>__newindex</code>表或者调用<code>__newindex</code>函数</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> st = &#123;&#125;</span><br><span class="line"><span class="keyword">local</span> t = <span class="built_in">setmetatable</span>(&#123;[<span class="string">&quot;aa&quot;</span>] = <span class="string">&quot;ss&quot;</span>&#125;, &#123;</span><br><span class="line">        <span class="built_in">__newindex</span> = st</span><br><span class="line">    &#125;)</span><br><span class="line">t.aa = <span class="string">&quot;ass&quot;</span></span><br><span class="line">t.bb = <span class="string">&quot;bss&quot;</span></span><br><span class="line"><span class="built_in">print</span>(t.aa)        <span class="comment">-- ass</span></span><br><span class="line"><span class="built_in">print</span>(t.bb)        <span class="comment">-- nil</span></span><br><span class="line"><span class="built_in">print</span>(st.aa)    <span class="comment">-- nil</span></span><br><span class="line"><span class="built_in">print</span>(st.bb)    <span class="comment">-- bss</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123;</span><br><span class="line">        <span class="built_in">__newindex</span> = <span class="function"><span class="keyword">function</span><span class="params">(self, key, value)</span></span></span><br><span class="line">            <span class="built_in">print</span>(key, value)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    &#125;)</span><br><span class="line">t.aa = <span class="string">&quot;ss&quot;</span>        <span class="comment">-- aa ss</span></span><br></pre></td></tr></table></figure>

<h3 id="rawset-rawget"><a href="#rawset-rawget" class="headerlink" title="rawset rawget"></a>rawset rawget</h3><p>如果一个表有元表, 但是又想绕开元表中的<code>__index</code> <code>__newindex</code>, 则用rawset和rawget函数, 表示只对表进行操作, 不动用元表</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rawset</span>(<span class="built_in">table</span>, key, value)     <span class="comment">-- 设置table的key索引对应值, 绕过元表__index</span></span><br><span class="line"><span class="built_in">rawget</span>(<span class="built_in">table</span>, key)            <span class="comment">-- 获取table的key索引对应值, 绕过元表__newindex</span></span><br></pre></td></tr></table></figure>

<h3 id="为表添加操作符"><a href="#为表添加操作符" class="headerlink" title="为表添加操作符"></a>为表添加操作符</h3><table>
<thead>
<tr>
<th>模式</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>__add</code></td>
<td>对应的运算符 <code>+</code></td>
</tr>
<tr>
<td><code>__sub</code></td>
<td>对应的运算符 <code>-</code></td>
</tr>
<tr>
<td><code>__mul</code></td>
<td>对应的运算符 <code>*</code></td>
</tr>
<tr>
<td><code>__div</code></td>
<td>对应的运算符 <code>/</code></td>
</tr>
<tr>
<td><code>__mod</code></td>
<td>对应的运算符 <code>%</code></td>
</tr>
<tr>
<td><code>__unm</code></td>
<td>对应的运算符 <code>-</code></td>
</tr>
<tr>
<td><code> __concat</code></td>
<td>对应的运算符 <code>..</code></td>
</tr>
<tr>
<td><code> __eq</code></td>
<td>对应的运算符 <code>==</code></td>
</tr>
<tr>
<td><code> __lt</code></td>
<td>对应的运算符 <code>&lt;</code></td>
</tr>
<tr>
<td><code> __le</code></td>
<td>对应的运算符 <code>&lt;=</code></td>
</tr>
</tbody></table>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123;</span><br><span class="line">        <span class="built_in">__add</span> = <span class="function"><span class="keyword">function</span><span class="params">(self, another)</span></span></span><br><span class="line">            <span class="comment">-- add operation</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">self</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    &#125;)</span><br><span class="line"><span class="built_in">print</span>(t + t)</span><br></pre></td></tr></table></figure>

<h3 id="call"><a href="#call" class="headerlink" title="__call"></a>__call</h3><p>可以让表对象直接像方法一样调用</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123;</span><br><span class="line">        <span class="built_in">__call</span> = <span class="function"><span class="keyword">function</span><span class="params">(self, ...)</span></span></span><br><span class="line">            <span class="built_in">print</span>(...)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;__call&quot;</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    &#125;)</span><br><span class="line"><span class="built_in">print</span>(t(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"><span class="comment">-- 输出</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="built_in">__call</span></span><br></pre></td></tr></table></figure>

<h3 id="tostring"><a href="#tostring" class="headerlink" title="__tostring"></a>__tostring</h3><p>修改表的输出行为</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = <span class="built_in">setmetatable</span>(&#123;<span class="string">&quot;a&quot;</span>, <span class="string">&quot;aa&quot;</span>, <span class="string">&quot;ss&quot;</span>&#125;, &#123;</span><br><span class="line">    <span class="built_in">__tostring</span> = <span class="function"><span class="keyword">function</span><span class="params">(self)</span></span></span><br><span class="line">        <span class="keyword">local</span> temp = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> _, v <span class="keyword">in</span> <span class="built_in">pairs</span>(<span class="built_in">self</span>) <span class="keyword">do</span></span><br><span class="line">            <span class="built_in">table</span>.<span class="built_in">insert</span>(temp, v)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;[&quot;</span>..<span class="built_in">table</span>.<span class="built_in">concat</span>(temp, <span class="string">&quot;,&quot;</span>)..<span class="string">&quot;]&quot;</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(t)        <span class="comment">-- [a, aa, ss]</span></span><br></pre></td></tr></table></figure>



<h2 id="协程"><a href="#协程" class="headerlink" title="协程"></a>协程</h2><p>单个Lua虚拟机只能工作在一个线程下, 如果真的想在lua中使用多线程, 可以看看lua多线程库<a target="_blank" rel="noopener" href="https://github.com/LuaLanes/lanes">Lanes</a>, <a target="_blank" rel="noopener" href="https://github.com/effil/effil">Effil</a>. 当然了, 多线程容易增加出错概率, 尽量不要用多线程</p>
<p>任意时刻, 只有一个协同程序在运行, 并且运行的协程只有明确的被要求挂起时才会挂起 (同步的多线程)</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>coroutine.create()</td>
<td>创建 coroutine，返回 coroutine， 参数是一个函数，当和 resume 配合使用的时候就唤醒函数调用</td>
</tr>
<tr>
<td>coroutine.resume()</td>
<td>重启 coroutine，和 create 配合使用</td>
</tr>
<tr>
<td>coroutine.yield()</td>
<td>挂起 coroutine，将 coroutine 设置为挂起状态，这个和 resume 配合使用能有很多有用的效果</td>
</tr>
<tr>
<td>coroutine.status()</td>
<td>查看 coroutine 的状态  注：coroutine 的状态有三种：dead，suspended，running，具体什么时候有这样的状态请参考下面的程序</td>
</tr>
<tr>
<td>coroutine.wrap（）</td>
<td>创建 coroutine，返回一个函数，一旦你调用这个函数，就进入 coroutine，和 create 功能重复</td>
</tr>
<tr>
<td>coroutine.running()</td>
<td>返回正在跑的 coroutine，一个 coroutine 就是一个线程，当使用running的时候，就是返回一个 corouting 的线程号</td>
</tr>
</tbody></table>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建协程</span></span><br><span class="line"><span class="keyword">local</span> co = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(<span class="function"><span class="keyword">function</span><span class="params">(i)</span></span></span><br><span class="line">        <span class="built_in">print</span>(i * i)</span><br><span class="line">    <span class="keyword">end</span>)</span><br><span class="line"><span class="comment">-- 运行协程, 传入参数</span></span><br><span class="line"><span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co, <span class="number">1</span>)         <span class="comment">-- 1</span></span><br><span class="line"><span class="comment">-- 协程运行结束, 回到当前协程</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">status</span>(co))        <span class="comment">-- dead</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- wrap创建的协程运行时如同调用一个函数, 注意不要与正常函数混淆</span></span><br><span class="line"><span class="keyword">local</span> co = <span class="built_in">coroutine</span>.<span class="built_in">wrap</span>(<span class="function"><span class="keyword">function</span><span class="params">(i)</span></span></span><br><span class="line">        <span class="built_in">print</span>(i * i)</span><br><span class="line">    <span class="keyword">end</span>)</span><br><span class="line"><span class="comment">-- 像函数一样调用</span></span><br><span class="line">co(<span class="number">2</span>)                            <span class="comment">-- 4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">status</span>(co))        <span class="comment">-- dead</span></span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 用协程创建一个类似python中的生成器</span></span><br><span class="line"><span class="keyword">local</span> co = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(<span class="function"><span class="keyword">function</span><span class="params">(count)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">running</span>())</span><br><span class="line">    <span class="keyword">local</span> i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">local</span> j = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;count: &quot;</span>..count)</span><br><span class="line">        count = <span class="built_in">coroutine</span>.<span class="built_in">yield</span>(j)    <span class="comment">-- yield也可以没有参数</span></span><br><span class="line">        i, j = j, i + j</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">status</span>(co))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">running</span>())</span><br><span class="line"><span class="comment">-- 头一次resume通过函数参数传入</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co, <span class="number">1</span>))</span><br><span class="line"><span class="comment">-- 之后resume的传入参数通过yield的返回值获取</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co, <span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co, <span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co, <span class="number">4</span>))</span><br><span class="line"><span class="comment">-- 输出</span></span><br><span class="line">suspended</span><br><span class="line">thread: <span class="number">0000000000</span>eb5e68        <span class="literal">true</span></span><br><span class="line">thread: <span class="number">0000000000</span>ebeee8        <span class="literal">false</span></span><br><span class="line">count: <span class="number">1</span></span><br><span class="line"><span class="literal">true</span>    <span class="number">1</span></span><br><span class="line">count: <span class="number">2</span></span><br><span class="line"><span class="literal">true</span>    <span class="number">1</span></span><br><span class="line">count: <span class="number">3</span></span><br><span class="line"><span class="literal">true</span>    <span class="number">2</span></span><br><span class="line">count: <span class="number">4</span></span><br><span class="line"><span class="literal">true</span>    <span class="number">3</span></span><br></pre></td></tr></table></figure>

<h2 id="文件IO"><a href="#文件IO" class="headerlink" title="文件IO"></a>文件IO</h2><p><a target="_blank" rel="noopener" href="https://www.runoob.com/lua/lua-file-io.html">https://www.runoob.com/lua/lua-file-io.html</a></p>
<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><h3 id="assert"><a href="#assert" class="headerlink" title="assert"></a>assert</h3><p>检查第一个参数, 若不为true, 则将第二个参数作为错误信息抛出</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(a,b)</span></span></span><br><span class="line">   <span class="built_in">assert</span>(<span class="built_in">type</span>(a) == <span class="string">&quot;number&quot;</span>, <span class="string">&quot;a 不是一个数字&quot;</span>)</span><br><span class="line">   <span class="built_in">assert</span>(<span class="built_in">type</span>(b) == <span class="string">&quot;number&quot;</span>, <span class="string">&quot;b 不是一个数字&quot;</span>)</span><br><span class="line">   <span class="keyword">return</span> a+b</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">add(<span class="number">10</span>)</span><br><span class="line"><span class="comment">-- 输出</span></span><br><span class="line">lua: test.lua:<span class="number">3</span>: b 不是一个数字</span><br><span class="line">stack <span class="built_in">traceback</span>:</span><br><span class="line">    [C]: <span class="keyword">in</span> <span class="function"><span class="keyword">function</span> &#x27;<span class="title">assert</span>&#x27;</span></span><br><span class="line"><span class="function">    <span class="title">test.lua</span>:3: <span class="title">in</span> <span class="title">local</span> &#x27;<span class="title">add</span>&#x27;</span></span><br><span class="line"><span class="function">    <span class="title">test.lua</span>:6: <span class="title">in</span> <span class="title">main</span> <span class="title">chunk</span></span></span><br><span class="line"><span class="function">    [<span class="title">C</span>]: <span class="title">in</span> ?</span></span><br></pre></td></tr></table></figure>

<h3 id="error"><a href="#error" class="headerlink" title="error"></a>error</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">error</span> (message [, level])</span><br></pre></td></tr></table></figure>

<p>终止正在执行的函数, 并将message内容作为错误信息 (error函数永不返回)</p>
<p>level:</p>
<ul>
<li>1 默认, 调用error的位置(文件+行号)</li>
<li>2 指出调用error的函数</li>
<li>0 不添加错误位置信息</li>
</ul>
<h3 id="pcall-amp-xpcall-amp-debug"><a href="#pcall-amp-xpcall-amp-debug" class="headerlink" title="pcall &amp; xpcall &amp; debug"></a>pcall &amp; xpcall &amp; debug</h3><h4 id="pcall"><a href="#pcall" class="headerlink" title="pcall"></a>pcall</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 接收一个函数和要传给它的参数, 返回true或者false, errorinfo</span></span><br><span class="line"><span class="built_in">pcall</span>(func, ...)</span><br></pre></td></tr></table></figure>

<p>pcall以保护模式运行函数, 但pcall返回时已经销毁了调用栈部分内容</p>
<h4 id="xpcall"><a href="#xpcall" class="headerlink" title="xpcall"></a>xpcall</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">xpcall</span>(func, err_handler, ...)</span><br></pre></td></tr></table></figure>

<p>额外接受一个错误处理函数, 发生错误时, 在调用栈展开之前调用错误处理函数, 于是可以在这个函数中使用debug库获取关于错误的额外信息</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">xpcall</span>(</span><br><span class="line">    <span class="function"><span class="keyword">function</span><span class="params">(i)</span></span></span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">error</span>(<span class="string">&quot;error...&quot;</span>)</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line">    <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">debug</span>.<span class="built_in">traceback</span>())</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line">    <span class="number">333</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">-- 输出</span></span><br><span class="line"><span class="number">333</span></span><br><span class="line">stack <span class="built_in">traceback</span>:</span><br><span class="line">        test.lua:<span class="number">8</span>: <span class="keyword">in</span> <span class="function"><span class="keyword">function</span> &lt;<span class="title">test.lua</span>:6&gt;</span></span><br><span class="line"><span class="function">        [<span class="title">C</span>]: <span class="title">in</span> <span class="title">function</span> &#x27;<span class="title">error</span>&#x27;</span></span><br><span class="line"><span class="function">        <span class="title">test.lua</span>:4: <span class="title">in</span> <span class="title">function</span> &lt;<span class="title">test.lua</span>:2&gt;</span></span><br><span class="line"><span class="function">        [<span class="title">C</span>]: <span class="title">in</span> <span class="title">function</span> &#x27;<span class="title">xpcall</span>&#x27;</span></span><br><span class="line"><span class="function">        <span class="title">test.lua</span>:1: <span class="title">in</span> <span class="title">main</span> <span class="title">chunk</span></span></span><br><span class="line"><span class="function">        [<span class="title">C</span>]: <span class="title">in</span> ?</span></span><br></pre></td></tr></table></figure>

<h2 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h2><p><a target="_blank" rel="noopener" href="https://www.runoob.com/lua/lua-debug.html">https://www.runoob.com/lua/lua-debug.html</a></p>
<h2 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>lua自动垃圾回收采用古老的解决循环引用情况的标记清扫法(Mark-and-Sweep)</p>
<ul>
<li><p>Mark (标记阶段)</p>
<p>默认情况下, 所有变量都标记为”可回收”, 回收时, 从根节点<code>_G</code>出发, 可达对象标记为”不可回收”</p>
</li>
<li><p>Sweep (清扫阶段)</p>
<p>遍历所有现存对象, 将标志位是”可回收”的对象释放, 同时将标记为”不可回收”的对象重新标记为”可回收”为下次gc做准备</p>
</li>
</ul>
<h3 id="G"><a href="#G" class="headerlink" title="_G"></a>_G</h3><p>lua中<code>_G</code>是一张表, 包含了所有的全局函数, 全局变量, 包括对自身的引用</p>
<h3 id="collectgarbage函数"><a href="#collectgarbage函数" class="headerlink" title="collectgarbage函数"></a>collectgarbage函数</h3><p>collectgarbage函数提供了垃圾回收操作的相关功能</p>
<p>停止垃圾回收；<br> 重启垃圾回收；<br> 强制执行一次回收循环；<br> 强制执行一步垃圾回收；<br> 获取Lua占用的内存；<br> 以及两个影响垃圾回收频率和步幅的参数。</p>
<h2 id="模块与包"><a href="#模块与包" class="headerlink" title="模块与包"></a>模块与包</h2><h3 id="模块定义和加载"><a href="#模块定义和加载" class="headerlink" title="模块定义和加载"></a>模块定义和加载</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- test.lua</span></span><br><span class="line"><span class="keyword">local</span> mymodule = &#123;&#125;</span><br><span class="line">mymodule.MAX_NUM = <span class="number">10</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mymodule.func1</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- some code</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;test&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">return</span> mymodule</span><br></pre></td></tr></table></figure>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- main.lua</span></span><br><span class="line"><span class="keyword">local</span> my = <span class="built_in">require</span>(<span class="string">&quot;test&quot;</span>)</span><br><span class="line">my.func1()</span><br></pre></td></tr></table></figure>

<p>也可以在模块中直接定义为全局变量, 然后require之后直接使用, 不用接受require返回值</p>
<h3 id="加载机制"><a href="#加载机制" class="headerlink" title="加载机制"></a>加载机制</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;模块名&quot;</span>)</span><br></pre></td></tr></table></figure>

<ol>
<li><p>首先查找package.loaded表, 检测是否被加载过, 如果加载过, 则require返回保存的值; 否则进行下面的步骤</p>
</li>
<li><p>在package的searchers表中, 有四个加载器, require按照顺序执行加载器, 找到了, 则成功返回, 没有就继续找</p>
<ul>
<li>预加载器 package.preload[modname], 一些特殊模块有预加载器</li>
<li>lua加载器查找package.path</li>
<li>c加载器查找package.cpath</li>
<li>一体化加载器</li>
</ul>
</li>
</ol>
<p>加载成功后</p>
<p>在package.loaded[‘mod’]中记录模块模块返回值, 如果模块没有返回值, 则设置为true;</p>
<p>在同一lua虚拟机中, 多次require同一模块, 模块只被加载一次, 得到的是同一个table, 并且任何地方修改table值, 其它地方引用的table也会改变</p>
<p>详细: <a target="_blank" rel="noopener" href="https://blog.csdn.net/zxm342698145/article/details/80607072">lua require加载机制</a></p>
<h2 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h2><p>lua中没有专门的类机制, 只有table可以用, 所以在lua中, 面向对象也是用table和元表来实现</p>
<h3 id="冒号语法糖"><a href="#冒号语法糖" class="headerlink" title="冒号语法糖"></a>冒号语法糖</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = &#123;&#125;</span><br><span class="line">t.MAX_NUM = <span class="number">30</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">t:show</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">self</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- 上面的定义相当于</span></span><br><span class="line">t.show = <span class="function"><span class="keyword">function</span><span class="params">(self)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">self</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- 调用</span></span><br><span class="line">t:show()</span><br><span class="line"><span class="comment">-- 相当于</span></span><br><span class="line">t.show(t)</span><br></pre></td></tr></table></figure>

<h3 id="用元表实现继承"><a href="#用元表实现继承" class="headerlink" title="用元表实现继承"></a>用元表实现继承</h3><p>self参数的合理利用, 实现”动态绑定”, 然后元表和<code>__index</code>实现继承父类数据效果</p>
<p>// todo</p>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/lua/" rel="tag"><i class="fa fa-tag"></i> Lua</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/other/software-version-code/" rel="prev" title="软件版本号管理">
      <i class="fa fa-chevron-left"></i> 软件版本号管理
    </a></div>
      <div class="post-nav-item">
    <a href="/python/python-logging/" rel="next" title="Python中的logging使用">
      Python中的logging使用 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Lua"><span class="nav-number">1.</span> <span class="nav-text">Lua</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%96%E8%AF%91Lua-5-3-5"><span class="nav-number">1.1.</span> <span class="nav-text">编译Lua 5.3.5</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="nav-number">1.2.</span> <span class="nav-text">基本语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Hello-Word"><span class="nav-number">1.2.1.</span> <span class="nav-text">Hello Word</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E9%87%8A"><span class="nav-number">1.2.2.</span> <span class="nav-text">注释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E5%B1%80-%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="nav-number">1.2.3.</span> <span class="nav-text">全局&#x2F;局部变量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.3.</span> <span class="nav-text">数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#nil"><span class="nav-number">1.3.1.</span> <span class="nav-text">nil</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E4%BD%9C%E4%B8%BA%E5%88%A4%E6%96%AD%E6%9D%A1%E4%BB%B6"><span class="nav-number">1.3.2.</span> <span class="nav-text">变量作为判断条件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="nav-number">1.4.</span> <span class="nav-text">流程控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%94%AF"><span class="nav-number">1.4.1.</span> <span class="nav-text">分支</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF"><span class="nav-number">1.4.2.</span> <span class="nav-text">循环</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">1.5.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89"><span class="nav-number">1.5.1.</span> <span class="nav-text">函数定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%A4%9A%E4%B8%AA%E5%80%BC"><span class="nav-number">1.5.2.</span> <span class="nav-text">返回多个值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0"><span class="nav-number">1.5.3.</span> <span class="nav-text">可变参数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.6.</span> <span class="nav-text">字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E7%A4%BA"><span class="nav-number">1.6.1.</span> <span class="nav-text">表示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-number">1.6.2.</span> <span class="nav-text">常用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">字符串格式化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D"><span class="nav-number">1.6.2.2.</span> <span class="nav-text">字符串模式匹配</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A8%E4%B8%8E%E6%95%B0%E7%BB%84"><span class="nav-number">1.7.</span> <span class="nav-text">表与数组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8"><span class="nav-number">1.7.1.</span> <span class="nav-text">表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E7%BB%84"><span class="nav-number">1.7.2.</span> <span class="nav-text">数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%81%8D%E5%8E%86"><span class="nav-number">1.7.3.</span> <span class="nav-text">遍历</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#table%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="nav-number">1.7.4.</span> <span class="nav-text">table常用函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%83%E8%A1%A8"><span class="nav-number">1.8.</span> <span class="nav-text">元表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E5%92%8C%E8%8E%B7%E5%8F%96%E5%85%83%E8%A1%A8"><span class="nav-number">1.8.1.</span> <span class="nav-text">设置和获取元表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#index"><span class="nav-number">1.8.2.</span> <span class="nav-text">__index</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#newindex"><span class="nav-number">1.8.3.</span> <span class="nav-text">__newindex</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rawset-rawget"><span class="nav-number">1.8.4.</span> <span class="nav-text">rawset rawget</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E8%A1%A8%E6%B7%BB%E5%8A%A0%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">1.8.5.</span> <span class="nav-text">为表添加操作符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#call"><span class="nav-number">1.8.6.</span> <span class="nav-text">__call</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tostring"><span class="nav-number">1.8.7.</span> <span class="nav-text">__tostring</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%8F%E7%A8%8B"><span class="nav-number">1.9.</span> <span class="nav-text">协程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6IO"><span class="nav-number">1.10.</span> <span class="nav-text">文件IO</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="nav-number">1.11.</span> <span class="nav-text">错误处理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#assert"><span class="nav-number">1.11.1.</span> <span class="nav-text">assert</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#error"><span class="nav-number">1.11.2.</span> <span class="nav-text">error</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pcall-amp-xpcall-amp-debug"><span class="nav-number">1.11.3.</span> <span class="nav-text">pcall &amp; xpcall &amp; debug</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#pcall"><span class="nav-number">1.11.3.1.</span> <span class="nav-text">pcall</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xpcall"><span class="nav-number">1.11.3.2.</span> <span class="nav-text">xpcall</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B0%83%E8%AF%95"><span class="nav-number">1.12.</span> <span class="nav-text">调试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6"><span class="nav-number">1.13.</span> <span class="nav-text">垃圾回收</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%9F%E7%90%86"><span class="nav-number">1.13.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#G"><span class="nav-number">1.13.2.</span> <span class="nav-text">_G</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#collectgarbage%E5%87%BD%E6%95%B0"><span class="nav-number">1.13.3.</span> <span class="nav-text">collectgarbage函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E5%9D%97%E4%B8%8E%E5%8C%85"><span class="nav-number">1.14.</span> <span class="nav-text">模块与包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9D%97%E5%AE%9A%E4%B9%89%E5%92%8C%E5%8A%A0%E8%BD%BD"><span class="nav-number">1.14.1.</span> <span class="nav-text">模块定义和加载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6"><span class="nav-number">1.14.2.</span> <span class="nav-text">加载机制</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.15.</span> <span class="nav-text">面向对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%92%E5%8F%B7%E8%AF%AD%E6%B3%95%E7%B3%96"><span class="nav-number">1.15.1.</span> <span class="nav-text">冒号语法糖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E5%85%83%E8%A1%A8%E5%AE%9E%E7%8E%B0%E7%BB%A7%E6%89%BF"><span class="nav-number">1.15.2.</span> <span class="nav-text">用元表实现继承</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">EricYe</p>
  <div class="site-description" itemprop="description">The compiler in my hand will be a part of my soul.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/fetasty" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fetasty" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:fetasty@outlook.com" title="E-Mail → mailto:fetasty@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.unrealengine.com/" title="https:&#x2F;&#x2F;www.unrealengine.com" rel="noopener" target="_blank">Unreal Engine</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://kexingfu.github.io/" title="http:&#x2F;&#x2F;kexingfu.github.io" rel="noopener" target="_blank">Kexingfu</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fas fa-heartbeat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">EricYe</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : true,
      notify     : false,
      appId      : 'IyyIsLTeEAleQasCvYmTAx6Q-gzGzoHsz',
      appKey     : '3laWJNFvNHzGHaRXfffC3K9H',
      placeholder: "文明用语暖人心, 遵纪守法好公民",
      avatar     : 'wavatar',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
